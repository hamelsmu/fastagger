---

title: Pdf Core


keywords: fastai
sidebar: home_sidebar

summary: "Basic pdf operations available to fastagger."
description: "Basic pdf operations available to fastagger."
nb_path: "00_pdf_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_pdf_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pdf2image</span> <span class="kn">import</span> <span class="n">convert_from_path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">checkPath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>  
        <span class="k">return</span> <span class="s2">&quot;folder&quot;</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>  
        <span class="k">return</span> <span class="s2">&quot;file&quot;</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;LICENSE&#39;</span><span class="p">)</span>
<span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;docs&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;doesNotExist&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">checkPath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">==</span>  <span class="s2">&quot;file&quot;</span> 
<span class="k">assert</span> <span class="n">checkPath</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;folder&quot;</span>
<span class="k">assert</span> <span class="n">checkPath</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">==</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="importPDFs" class="doc_header"><code>importPDFs</code><a href="https://github.com/fabraz/fastagger/tree/master/fastagger/pdf_core.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>importPDFs</code>(<strong><code>path</code></strong>, <strong><code>outputFolder</code></strong>, <strong><code>dpi</code></strong>=<em><code>200</code></em>, <strong><code>grayscale</code></strong>=<em><code>True</code></em>, <strong><code>size</code></strong>=<em><code>(600, 846)</code></em>)</p>
</blockquote>
<p>imports pdf pages to folder
path: string path for the file or folder
recursive: boolean choice for traversing the path folder searching for pdf files
outputFolder: pages image folder destiny
dpi: image quality, default 200
grayscale: filter to grayscale, default True
size: page image size, default (600, 846)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">AlreadyImportedError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">importPDF</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">outputFolder</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">846</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Imports pdf pages to folder</span>
<span class="sd">    filePath: tring path for the file to be imported</span>
<span class="sd">    outputFolder: pages image folder destiny</span>
<span class="sd">    dpi: image quality, default 200</span>
<span class="sd">    grayscale: filter to grayscale, default True</span>
<span class="sd">    size: page image size, default (600, 846)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">checkPath</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fileName</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pdf&#39;</span><span class="p">):</span>
            <span class="n">fileNameBase</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">fileName</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">outputFolder</span> <span class="o">=</span> <span class="n">outputFolder</span> <span class="o">+</span> <span class="n">fileNameBase</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">AlreadyImportedError</span><span class="p">(</span><span class="s1">&#39;Pdf already imported: &#39;</span><span class="p">,</span><span class="n">fileName</span><span class="p">)</span>                      
            <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="n">fileNameBase</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pages</span> <span class="o">=</span> <span class="n">convert_from_path</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">846</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not convert from path: &quot;</span><span class="p">,</span> <span class="n">filePath</span><span class="p">)</span>                      

            <span class="n">metadata</span><span class="p">[</span><span class="n">fileNameBase</span><span class="p">][</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputFolder</span>
            <span class="n">metadata</span><span class="p">[</span><span class="n">fileNameBase</span><span class="p">][</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not create folder: &quot;</span><span class="p">,</span> <span class="n">outputFolder</span><span class="p">)</span>
                
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">page</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outputFolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">fileNameBase</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;PNG&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not save file:&quot;</span><span class="p">,</span> <span class="n">outputFolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">fileNameBase</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>            
            <span class="k">return</span> <span class="n">metadata</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;File must be pdf: &#39;</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Invalid file path&#39;</span><span class="p">,</span> <span class="n">filePath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

